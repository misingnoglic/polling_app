# Intro

This is a Django app for advanced polling. Will hopefully be fun :)

# Setup Guide

- Install Python 3.6+
- Create a new virtual environment and source it
 (I like to use [virtualenvwrapper](https://virtualenvwrapper.readthedocs.io/en/latest/))
- run `pip install -r requirements.txt`
- Create a file `poll/app_secrets.py` and ask Arya for the contents.
- Run `python test_setup_script.py` - it should print out a large JSON at the end.
- Run `python manage.py test polls` - make sure all tests pass.
- Run `python manage.py runserver` to run the test local instance.

# Important Files

This may be redundant for people who have used Django, but here are a summary of the important files:

- `poll/` - This folder keeps files for the whole project.
 - `app_secrets.py` - Keep secrets in here, and don't commit to git. Get this from Arya.
 - `settings.py` - Global settings for the whole project.
 - `urls.py` - Controls global URL routing for whole project.

- `polls/` - Keeps files specific to the `poll` app. This is currently the only app in the project, but this may change later (e.g. if we add social features).
 - `migrations/` - Autogenerated files that keep track of database changes. For now we are not committing to these since the database is in a state of constant fluctuation, but when we are more stable these will be kept and maintained to keep data sanitized.
 - `admin.py` - Keeps settings for the polls models admin panel.
 - `constants.py` - Keep any non-secret constants for the polls app here.
 - `models.py` - Contains logic for the database models. The Django ORM converts these python objects to database models, and in the code they can be treated like regular python objects (e.g. they can have their own methods). Whenever updating the models, be sure to migrate the fields.
 - `test.py` - Contains tests for the polls app. Please try to test every unique model or poll you create, so that any subsequent changes don't break your work. It may seem time consuming, but it will save future work. Run tests with `python manage.py test polls`
 - `urls.py` - Controls URL routing for the polls app. Each URL route is connected to a view (see views.py).
 - `views.py` - Contains the logic for what the app will do when a certain URL is hit. Can call database, and render HTML templates.
- `templates/` - Contains HTML templates with templating language to allow views to insert variables into the templates.
- `.gitignore` - Contains list of files not to add to repo, e.g. app_secrets.py
- `README.md` - Contains documentation about project.
- `requirements.txt` - Contains list of packages required for this app to run. Generate with `pip freeze > requirements.txt`
- `test_setup_script` - Simple script to clean the database of all data and add some basic data to the database. Deletes migration files since we don't care about migrating old data for now.

# How a Django request is handled.

- Browser makes a request to a URL.
- poll/urls.py is used to figure out what app to route the request to.
- The urls.py file for that app will decide what view to call, and with what variables.
- That view will gather any required database models, and then render a template which will be returned to the browser to display.